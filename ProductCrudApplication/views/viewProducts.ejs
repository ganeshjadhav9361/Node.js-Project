<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>View All Product</title>
    <script type="text/javascript" src="ajax.js" ></script>
</head>
<body >
    <%- include("home.ejs") %>
    <br><br>
    <center>
    
<h1 class="text-info">All Product Details</h1>
<div class="form-group bg-dark p-2">
            <input type="text" class="form-control control" name="name" 
                placeholder="Enter Product Name" onkeyup="SearchProduct(this.value)"/>
        </div>
          <% if (typeof msg !== 'undefined' && msg) { %>
  <div class="alert alert-success">
    <% console.log("MSG in EJS:", msg); %>

    <%= msg %>
  </div>
<% } %>

        
<table class="table table-bordered table-stripted table-hover bg-dark text-light">
    <tr>
        <th> SR.NO</th>
        <th> NAME</th>
        <th> CATEGORY</th>
        <th> PRICE</th>
        <th> QUANTITY</th>
        <th>DELETE</th>
        <th> UPDATE</th>
    </tr>

    <tbody id="bodydata" class="table text-dark" style="font-size: 20px;">
      
       <% if (Array.isArray(prodList) && prodList.length > 0) { %>
          
           <% prodList.forEach((row,index)=>{ %>
                
                <tr>
                    <td><%=index+1%></td>
                    <td><%=row.name%></td>
                    <td><%=row.category%></td>
                    <td><%=row.price%></td>
                    <td><%=row.quantity%></td>
                    <td><a href="/delProd?pid=<%=row.pid%>" onclick="return confirm('Are you sure you want to delete this product?');">DELETE</a></td>
                    <td><a href="/updprod?pid=<%=row.pid%>&name=<%=row.name%>&category=<%=row.category%>&price=<%=row.price%>&quantity=<%=row.quantity%>">UPDATE</a></td>

                </tr>
                 <% }); %>
        <% } else { %>
          <tr><td colspan="7">No Data Found</td></tr>
        <% } %>
         
    </tbody>
    
</table>

</center>

<script>
  setTimeout(() => {
    const alert = document.querySelector(".alert");
    if (alert) alert.remove();
  }, 3000); 
</script>

</body>
</html>